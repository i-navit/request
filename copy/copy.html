<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex,nofollow">
<title>å®šå‹æ–‡ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ã‚³ãƒ”ãƒ¼(ã¼ã£ã¡ã‚“ã‚¬ã‚¤ãƒ‰)</title>
<link rel="icon" href="https://i-navit.github.io/request/favicon.ico" type="image/x-icon">
<script>/* ã€ï¼é‡è¦ï¼ã€‘reCAPTCHAã®èªè¨¼(ã‚µã‚¤ãƒˆã‚­ãƒ¼ã‚’è¨˜å…¥)  */</script>
<script src="https://www.google.com/recaptcha/api.js?render=6Lf6STQrAAAAAOrsIXuWUujmwytnGlS8DGd_KsBe"></script>
<style>
  body {
    font-family: sans-serif;
    padding: 5px 20px;
    text-align: left;
    background-color: #fff;
    color: #3e3e3e;
    /* PCè¡¨ç¤ºã§ã®ãƒ™ãƒ¼ã‚¹ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’å°‘ã—å¤§ããã—ã¦è¦‹ã‚„ã™ãèª¿æ•´ */
    font-size: 16px;
  }
  .container {
    width: 100%;
    margin-bottom: 15px;
  }
  .copyTarget {
    padding: 8px 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f9f9f9;
    width: 100%;
    box-sizing: border-box;
    text-align: left;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ  */
    word-wrap: break-word;
  }
  .copyTarget:hover {
    background-color: #ffff99; /* ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®èƒŒæ™¯è‰² */
  }
  .message {
    display: none;
    margin-top: 5px;
    color: #ff0099;
    font-weight: bold;
  }
  .customkey_ttl {
    background: #a78acb;
    color: #fff;
    font-weight: bold;
    padding: 0.5em 1em 0.2em;
    display: inline-block;
    margin-bottom: 0;
    border-radius: 5px 5px 0 0;
  }
  .customkey_box {
    border-radius: 0 5px 5px 5px;
    background: #e0e0ff;
    padding: 1em;
  }
  #customkey-input {
    width: 100%;
    padding: 8px; /* å°‘ã—ä½™ç™½ã‚’åºƒã’ã‚‹ */
    box-sizing: border-box;
    font-size: 1em; /* è¦ªè¦ç´ ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’ç¶™æ‰¿ */
  }

  /* â˜…â˜…â˜…ã€å¤‰æ›´ç‚¹â‘¡ã€‘ã‚¹ãƒãƒ›è¡¨ç¤ºç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  â˜…â˜…â˜… */
  @media screen and (max-width: 768px) {
    body {
      /* å…¨ä½“ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’ã‚¹ãƒãƒ›å‘ã‘ã«èª¿æ•´ */
      font-size: 14px;
      /* å·¦å³ã®ä½™ç™½ã‚’å°‘ã—ç‹­ãã™ã‚‹ */
      padding: 5px 15px;
      /* ãƒ†ã‚­ã‚¹ãƒˆãŒé•·ããªã£ãŸæ™‚ã«ã€å¤‰ãªã¨ã“ã‚ã§æ”¹è¡Œã•ã‚Œã‚‹ã®ã‚’é˜²ã */
      -webkit-text-size-adjust: 100%;
    }

    .copyTarget {
      /* ãƒœã‚¿ãƒ³å†…ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’èª¿æ•´ (bodyã«åˆã‚ã›ã‚‹) */
      font-size: 1em;
      /* ä¸Šä¸‹ã®ä½™ç™½ã‚’å°‘ã—åºƒã’ã¦ã‚¿ãƒƒãƒ—ã—ã‚„ã™ãã™ã‚‹ */
      padding: 8px 12px;
    }

    .customkey_ttl {
      /* ã‚¿ã‚¤ãƒˆãƒ«ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
      font-size: 0.9em;
    }
  }

</style>
</head>
<body>

<div class="customkey_ttl">ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ã­</div>
<div class="customkey_box">
  <input type="text" id="customkey-input" placeholder="ã“ã“ã«ã‚­ãƒ¼ã‚’å…¥åŠ›">
  <div class="container" style="margin-top:10px;">
    <p class="copyTarget" id="customkey-output"></p>
    <p class="message">ã‚³ãƒ”ãƒ¼å®Œäº†ï¼</p>
  </div>
</div>

<div id="spreadsheet-data-container">
  <p>èª­ã¿è¾¼ã¿ä¸­...</p>
</div>

<script>
// â˜…â˜…â˜…ã€è¦è¨­å®šã€‘ã‚¹ãƒ†ãƒƒãƒ—3ã§ã‚³ãƒ”ãƒ¼ã—ãŸGASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’è²¼ã‚Šä»˜ã‘ã¦ã­ï¼ â˜…â˜…â˜…
const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbz7kyB_Ys8X2SM5fFNpa0T6jO2jU6X0R9_PKBuye8qCY8_a__h8Q__wPwJ9kjNsYIg7/exec';

document.addEventListener('DOMContentLoaded', () => {
  const customKeyInput = document.getElementById('customkey-input');
  const customKeyOutput = document.getElementById('customkey-output');
  const dataContainer = document.getElementById('spreadsheet-data-container');
  let customKeyTemplate = '';

  // â‘  ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã®å…¥åŠ›ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åå¿œã™ã‚‹å‡¦ç†
  customKeyInput.addEventListener('input', updateCustomKeyOutput);

  function updateCustomKeyOutput() {
    const inputValue = customKeyInput.value;
    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® 'â˜…' ã‚’å…¥åŠ›å€¤ã§ç½®ãæ›ãˆã‚‹
    customKeyOutput.innerText = customKeyTemplate.replace('â˜…', inputValue);
  }

  // â‘¡ Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€å‡¦ç†
  fetch(GAS_WEB_APP_URL)
    .then(response => {
      if (!response.ok) {
        throw new Error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚');
      }
      return response.json();
    })
    .then(data => {
      if (data.error) {
        throw new Error(data.error);
      }
      
      dataContainer.innerHTML = ''; // ã€Œèª­ã¿è¾¼ã¿ä¸­...ã€ã‚’æ¶ˆå»

      // ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ›´æ–°
      customKeyTemplate = data.customKey || 'ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ğŸ”‘â˜…';
      updateCustomKeyOutput();

      // å®šå‹æ–‡ã‚’HTMLã«æç”»
      if (data.phrases.length > 0) {
        data.phrases.forEach(phrase => {
          const div = document.createElement('div');
          div.className = 'container';

          const pCopy = document.createElement('p');
          pCopy.className = 'copyTarget';
          pCopy.innerText = phrase;

          const pMessage = document.createElement('p');
          pMessage.className = 'message';
          pMessage.innerText = 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼';

          div.appendChild(pCopy);
          div.appendChild(pMessage);
          dataContainer.appendChild(div);
        });
      } else {
        dataContainer.innerHTML = '<p>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å®šå‹æ–‡ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
      }
    })
    .catch(error => {
      console.error('Fetch Error:', error);
      dataContainer.innerHTML = `<p style="color:red;">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}</p>`;
    });
});

// â‘¢ ã‚³ãƒ”ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå§”ä»»ï¼‰
document.body.addEventListener('click', function(event) {
  if (event.target && event.target.classList.contains('copyTarget')) {
    const targetElement = event.target;
    // ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã®å ´åˆã¯ã‚³ãƒ”ãƒ¼ã—ãªã„
    if (!targetElement.innerText.trim()) {
      return;
    }

    const textToCopy = targetElement.innerText;
    const messageElement = targetElement.nextElementSibling; 

    if (!messageElement || !messageElement.classList.contains('message')) {
      console.error('å¯¾å¿œã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
      return;
    }

    navigator.clipboard.writeText(textToCopy)
      .then(() => {
        messageElement.style.display = "block";
        setTimeout(() => {
          messageElement.style.display = "none";
        }, 1200);
      })
      .catch(err => {
        console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®æ›¸ãè¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
        messageElement.textContent = "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
        messageElement.style.color = "red";
        messageElement.style.display = "block";
        setTimeout(() => {
          messageElement.style.display = "none";
          messageElement.textContent = "ã‚³ãƒ”ãƒ¼å®Œäº†ï¼";
          messageElement.style.color = "#ff0099"; // å…ƒã®è‰²ã«æˆ»ã™
        }, 3000);
      });
  }
});
</script>

</body>
</html>
