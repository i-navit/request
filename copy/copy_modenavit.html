<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex,nofollow">
<title>å®šå‹æ–‡ã‚¯ã‚¤ãƒƒã‚¯ã‚³ãƒ”ãƒ¼(ãƒŠãƒ“ãƒƒãƒˆç”¨)</title>
<link rel="icon" href="https://i-navit.github.io/request/favicon.ico" type="image/x-icon">
<style>
  body {
    font-family: sans-serif;
    padding: 5px 20px;
    text-align: left;
    background-color: #fff;
    color: #333333;
    /* PCè¡¨ç¤ºã§ã®ãƒ™ãƒ¼ã‚¹ã®æ–‡å­—ã‚µã‚¤ã‚º */
    font-size: 14px;
  }
  .container {
    width: 100%;
    margin-bottom: 15px;
  }
  .copyTarget {
    padding: 8px 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    background-color: #f9f9f9;
    width: 100%;
    box-sizing: border-box;
    text-align: left;
    cursor: pointer;
    transition: background-color 0.2s ease-in-out; /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ®‹ã™ */
    word-wrap: break-word;
  }
  .copyTarget.clicked { /* æ–°ã—ãè¿½åŠ ã™ã‚‹ã‚¯ãƒ©ã‚¹ */
    background-color: #ffff99;
  }
  .message {
    display: none;
    margin-top: 5px;
    color: #ff0099;
    font-weight: bold;
  }
  .customkey_ttl {
    background: #a78acb;
    color: #fff;
    font-weight: bold;
    padding: 0.5em 1em 0.2em;
    display: inline-block;
    margin-bottom: 0;
    border-radius: 5px 5px 0 0;
  }
  .customkey_box {
    border-radius: 0 5px 5px 5px;
    background: #e0e0ff;
    padding: 1em;
  }
  #customkey-input {
    width: 100%;
    max-width: 180px; /* â˜…ã“ã“ã‚’è¿½åŠ  (ã‚µã‚¤ã‚ºèª¿æ•´æ¸ˆã¿)â˜… */
    padding: 8px;
    box-sizing: border-box;
    font-size: 1em;
    display: inline-block; /* â˜…ã“ã“ã‚‚è¿½åŠ  (ãƒœã‚¿ãƒ³ã¨æ¨ªä¸¦ã³ã«ã™ã‚‹ãŸã‚)â˜… */
    vertical-align: middle; /* â˜…ã“ã“ã‚‚è¿½åŠ  (ãƒœã‚¿ãƒ³ã¨ä¸­å¤®æƒãˆã«ã™ã‚‹ãŸã‚)â˜… */
  }
  /* 1æ–‡å­—æ¶ˆã™ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
  #delete-last-char-button {
    margin-left: 5px;
    padding: 5px 8px;
    font-size: 0.8em;
    vertical-align: middle; /* â˜…ã“ã“ã‚‚è¿½åŠ  (inputã¨ä¸­å¤®æƒãˆã«ã™ã‚‹ãŸã‚)â˜… */
    border: 1px solid #a78acb;
    border-radius: 5px;
    background-color: #f0f0ff;
    cursor: pointer;
  }
  #delete-last-char-button:hover {
    background-color: #dcdcfe;
  }
  .ColorTxt {
  color: #00FF00;
  }

  /* â˜…â˜…â˜…ã€å¤‰æ›´ç‚¹â‘¡ã€‘ã‚¹ãƒãƒ›è¡¨ç¤ºç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¿½åŠ  â˜…â˜…â˜… */
  @media screen and (max-width: 768px) {
    body {
      /* å…¨ä½“ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’ã‚¹ãƒãƒ›å‘ã‘ã«èª¿æ•´ */
      font-size: 13px;
      /* å·¦å³ã®ä½™ç™½ã‚’å°‘ã—ç‹­ãã™ã‚‹ */
      padding: 5px 15px;
      /* ãƒ†ã‚­ã‚¹ãƒˆãŒé•·ããªã£ãŸæ™‚ã«ã€å¤‰ãªã¨ã“ã‚ã§æ”¹è¡Œã•ã‚Œã‚‹ã®ã‚’é˜²ã */
      -webkit-text-size-adjust: 100%;
    }

    .copyTarget {
      /* ãƒœã‚¿ãƒ³å†…ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’èª¿æ•´ (bodyã«åˆã‚ã›ã‚‹) */
      font-size: 1em;
      /* ä¸Šä¸‹ã®ä½™ç™½ã‚’å°‘ã—åºƒã’ã¦ã‚¿ãƒƒãƒ—ã—ã‚„ã™ãã™ã‚‹ */
      padding: 8px 12px;
    }

    .customkey_ttl {
      /* ã‚¿ã‚¤ãƒˆãƒ«ã®æ–‡å­—ã‚µã‚¤ã‚ºã‚’èª¿æ•´ */
      font-size: 0.9em;
    }
    /* ã‚¹ãƒãƒ›ã§ã®ãƒœã‚¿ãƒ³ã¨å…¥åŠ›æ¬„ã®èª¿æ•´ */
    #customkey-input {
      max-width: calc(100% - 80px); /* ãƒœã‚¿ãƒ³ã®å¹…ã‚’è€ƒæ…®ã—ã¦èª¿æ•´ */
    }
    #delete-last-char-button {
      font-size: 0.7em;
      padding: 4px 6px;
    }
  }

</style>
</head>
<body>

<div class="customkey_ttl">ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ã­</div>
<div class="customkey_box">
  <input type="text" id="customkey-input" placeholder="ã“ã“ã«ã‚­ãƒ¼ã‚’å…¥åŠ›">
  <button id="delete-last-char-button">â—€</button>
  <div class="container" style="margin-top:10px;">
    <p class="copyTarget" id="customkey-output"></p>
    <p class="message">ã‚³ãƒ”ãƒ¼å®Œäº†ï¼</p>
  </div>
</div>

<div id="spreadsheet-data-container">
  <p>èª­ã¿è¾¼ã¿ä¸­...</p>
</div>

<script>
// â˜…â˜…â˜…ã€è¦è¨­å®šã€‘ã‚¹ãƒ†ãƒƒãƒ—3ã§ã‚³ãƒ”ãƒ¼ã—ãŸGASã®ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªURLã‚’è²¼ã‚Šä»˜ã‘ã‚‹ â˜…â˜…â˜…
const GAS_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwc9D30mzB2PFp7M1ePUmYJyz1OWTkzb6XBVS69Mz2ohpS_q4V_lMRXGvJny3tAEzyC/exec';

document.addEventListener('DOMContentLoaded', () => {
  const customKeyInput = document.getElementById('customkey-input');
  const customKeyOutput = document.getElementById('customkey-output');
  const dataContainer = document.getElementById('spreadsheet-data-container');
  const deleteButton = document.getElementById('delete-last-char-button'); // â˜…ã“ã“ã‚’è¿½åŠ â˜…
  let customKeyTemplate = '';

  // â‘  ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã®å…¥åŠ›ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§åå¿œã™ã‚‹å‡¦ç†
  customKeyInput.addEventListener('input', updateCustomKeyOutput);

  function updateCustomKeyOutput() {
    const inputValue = customKeyInput.value;
    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã® 'â˜…' ã‚’å…¥åŠ›å€¤ã§ç½®ãæ›ãˆã‚‹
    customKeyOutput.innerHTML = customKeyTemplate.replace('â˜…', inputValue); // â˜…ã“ã“ã‚’innerTextã‹ã‚‰innerHTMLã«å¤‰æ›´â˜…
  }

  // â˜…ã“ã“ã‹ã‚‰è¿½åŠ â˜…
  // â‘¢ 1æ–‡å­—æ¶ˆã™ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
  deleteButton.addEventListener('click', () => {
    let currentValue = customKeyInput.value;
    if (currentValue.length > 0) {
      customKeyInput.value = currentValue.slice(0, -1); // æœ€å¾Œã®1æ–‡å­—ã‚’å‰Šé™¤
      updateCustomKeyOutput(); // è¡¨ç¤ºã‚‚æ›´æ–°
    }
    // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’æˆ»ã—ã¦ç¶šã‘ã¦å…¥åŠ›ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
    customKeyInput.focus();
  });
  // â˜…ã“ã“ã¾ã§è¿½åŠ â˜…

  // â‘¡ Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€å‡¦ç†
  fetch(GAS_WEB_APP_URL)
    .then(response => {
      if (!response.ok) {
        throw new Error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å¿œç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚');
      }
      return response.json();
    })
    .then(data => {
      if (data.error) {
        throw new Error(data.error);
      }
      
      dataContainer.innerHTML = ''; // ã€Œèª­ã¿è¾¼ã¿ä¸­...ã€ã‚’æ¶ˆå»

      // ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ›´æ–°
      customKeyTemplate = data.customKey || 'ã‚«ã‚¹ã‚¿ãƒ ã‚­ãƒ¼ğŸ”‘â˜…';
      updateCustomKeyOutput();

      // å®šå‹æ–‡ã‚’HTMLã«æç”»
      if (data.phrases.length > 0) {
        data.phrases.forEach(phrase => {
          const div = document.createElement('div');
          div.className = 'container';

          const pCopy = document.createElement('p');
          pCopy.className = 'copyTarget';
          pCopy.innerHTML = phrase; // â˜…ã“ã“ã‚’innerTextã‹ã‚‰innerHTMLã«å¤‰æ›´â˜…

          const pMessage = document.createElement('p');
          pMessage.className = 'message';
          pMessage.innerText = 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼';

          div.appendChild(pCopy);
          div.appendChild(pMessage);
          dataContainer.appendChild(div);
        });
      } else {
        dataContainer.innerHTML = '<p>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å®šå‹æ–‡ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
      }
    })
    .catch(error => {
      console.error('Fetch Error:', error);
      dataContainer.innerHTML = `<p style="color:red;">ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ: ${error.message}</p>`;
    });
});

// â‘¢ ã‚³ãƒ”ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆå§”ä»»ï¼‰
document.body.addEventListener('click', function(event) {
  if (event.target && event.target.classList.contains('copyTarget')) {
    const targetElement = event.target;
    // ãƒ†ã‚­ã‚¹ãƒˆãŒç©ºã®å ´åˆã¯ã‚³ãƒ”ãƒ¼ã—ãªã„
    if (!targetElement.innerText.trim()) {
      return;
    }

    const textToCopy = targetElement.innerText;
    const messageElement = targetElement.nextElementSibling;  

    if (!messageElement || !messageElement.classList.contains('message')) {
      console.error('å¯¾å¿œã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚');
      return;
    }

    // â˜…è¿½åŠ ã“ã“ã‹ã‚‰â˜…
    // ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã—ã¦èƒŒæ™¯è‰²ã‚’å¤‰ãˆã‚‹
    targetElement.classList.add('clicked'); 
    // â˜…è¿½åŠ ã“ã“ã¾ã§â˜…

    navigator.clipboard.writeText(textToCopy)
      .then(() => {
        messageElement.style.display = "block";
        setTimeout(() => {
          messageElement.style.display = "none";
          // â˜…è¿½åŠ ã“ã“ã‹ã‚‰â˜…
          // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºå¾Œã«ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã—ã¦èƒŒæ™¯è‰²ã‚’å…ƒã«æˆ»ã™
          targetElement.classList.remove('clicked'); 
          // â˜…è¿½åŠ ã“ã“ã¾ã§â˜…
        }, 1200);
      })
      .catch(err => {
        console.error('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã®æ›¸ãè¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
        messageElement.textContent = "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚";
        messageElement.style.color = "red";
        messageElement.style.display = "block";
        setTimeout(() => {
          messageElement.style.display = "none";
          messageElement.textContent = "ã‚³ãƒ”ãƒ¼å®Œäº†ï¼";
          messageElement.style.color = "#ff0099"; // å…ƒã®è‰²ã«æˆ»ã™
          // â˜…è¿½åŠ ã“ã“ã‹ã‚‰â˜…
          // ã‚¨ãƒ©ãƒ¼æ™‚ã«ã‚‚ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤ã—ã¦èƒŒæ™¯è‰²ã‚’å…ƒã«æˆ»ã™
          targetElement.classList.remove('clicked'); 
          // â˜…è¿½åŠ ã“ã“ã¾ã§â˜…
        }, 3000);
      });
  }
});
</script>

</body>
</html>
